# 📕 18QUAD 開発日報 - 2025年5月6日（第16日）

## 🎯 本日のテーマ：「幽霊グループの名を呼べ」

画面は正常、ボタンも光る。  
だが押した瞬間、通知はエラーで砕け散った。

そう――グループの名が、どこにも、なかったのだ。

---

## ✅ 主な進捗

- 🔄 通知機能の復活：`notification_menu.dart` を復活し、未読通知の表示とメニュー展開に成功。
- 📣 通知送信処理を共通関数化し、`admin_group_requests_screen.dart` / `group_request_screen.dart` に適用。
- 🧭 リクエスト登録先を `users/{uid}/group_requests` からルートの `groupRequests` コレクションへ一本化（スキーマ・コード双方対応）。
- 🪓 エラー「TypeError: Null is not a subtype of String」を撃破。
  - 原因：`requestData['groupName']` が null。
  - 対策：共通関数 `getGroupName()` を使用し、画面側での Firebase 直読みを排除。

---

## 🧨 苦戦の記録

- 😱 `isEquarlTo`？タイポを疑った開発者の怒りがログに刻まれる。
- 🕵️‍♂️ 表示されないリクエスト → Firestoreインデックス不足が原因と見せかけて、実は**クエリ条件の順序不一致**。
- 🤬 修正前と行数が合わない件で「さっさとやれ」5連発。行数と格闘する一日。
- 🤖 `groupName` がない件、画面で使うのにスキーマに定義されておらず、「直接取得はルール違反」という地獄の三すくみ。

---

## ✨ 五所川原のことば

> 「名を知らぬグループに通知を送るな。名を知らぬ者を却下するな。名を知る者こそが、通知の資格を得る」

---

## 🧩 総括

**共通化と整備の一日。だが、名もなきグループの亡霊は、まだ成仏していない。**  
一歩前進、半歩錯乱、それでも18QUADは進む。  
明日は却下通知の完全実装と、UIの最終整合へ。