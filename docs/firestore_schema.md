# Firestore ãƒ‡ãƒ¼ã‚¿æ§‹é€ å®šç¾©ï¼ˆ18QUAD 2025-05-01æ™‚ç‚¹ï¼‰

---

## ğŸ”¹ usersï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ï¼‰

**ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³åï¼š** `users`

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å   | å‹       | èª¬æ˜                                      |
|----------------|----------|-------------------------------------------|
| uid            | string   | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®UIDï¼ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDã¨ä¸€è‡´ï¼‰      |
| displayName    | string   | è¡¨ç¤ºå                                    |
| email          | string   | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆèªè¨¼ã«ä½¿ç”¨ï¼‰              |
| iconUrl        | string   | ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒã®URLï¼ˆç©ºãªã‚‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰  |
| groupId        | string   | æ‰€å±ã‚°ãƒ«ãƒ¼ãƒ—IDï¼ˆæœªæ‰€å±ãªã‚‰ç©ºï¼‰             |
| status         | string   | çŠ¶æ…‹ï¼ˆnone, member, managerï¼‰             |
| createdAt      | timestamp| ç™»éŒ²æ—¥æ™‚                                  |

---

### ğŸ”¸ ã‚µãƒ–ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ï¼šusers/{uid}/group_requests

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å   | å‹       | èª¬æ˜                                   |
|----------------|----------|----------------------------------------|
| requesterId    | string   | ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼UID         |
| groupId        | string   | ç”³è«‹å¯¾è±¡ã®ã‚°ãƒ«ãƒ¼ãƒ—ID                   |
| inviteCode     | string   | å…¥åŠ›ã—ãŸæ‹›å¾…ã‚³ãƒ¼ãƒ‰                     |
| message        | string   | ç”³è«‹æ™‚ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆä»»æ„ï¼‰             |
| status         | string   | çŠ¶æ…‹ï¼ˆpending, approved, rejectedï¼‰    |
| createdAt      | timestamp| ä½œæˆæ—¥æ™‚                               |

---

## ğŸ”¹ groupsï¼ˆã‚°ãƒ«ãƒ¼ãƒ—æƒ…å ±ï¼‰

**ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³åï¼š** `groups`

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å   | å‹       | èª¬æ˜                                  |
|----------------|----------|---------------------------------------|
| name           | string   | ã‚°ãƒ«ãƒ¼ãƒ—å                            |
| description    | string   | ã‚°ãƒ«ãƒ¼ãƒ—ç´¹ä»‹æ–‡ï¼ˆä»»æ„ï¼‰                |
| iconUrl        | string   | ã‚°ãƒ«ãƒ¼ãƒ—ç”»åƒURL                       |
| inviteCode     | string   | æ‹›å¾…ã‚³ãƒ¼ãƒ‰                            |
| createdBy      | string   | ä½œæˆè€…UID                             |
| ownerUid       | string   | ã‚°ãƒ«ãƒ¼ãƒ—é•·UIDï¼ˆæ‰¿èªè€…ï¼‰               |
| createdAt      | timestamp| ä½œæˆæ—¥æ™‚                              |

---

## ğŸ”¹ daily_countsï¼ˆé€£æ‰“è¨˜éŒ²ãƒ­ã‚°ï¼‰

**ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³åï¼š** `daily_counts`

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | å‹       | èª¬æ˜                     |
|--------------|----------|--------------------------|
| uid          | string   | ãƒ¦ãƒ¼ã‚¶ãƒ¼UID              |
| day          | string   | æ—¥ä»˜ï¼ˆyyyy-MM-ddï¼‰       |
| month        | string   | æœˆï¼ˆyyyy-MMï¼‰            |
| year         | string   | å¹´ï¼ˆyyyyï¼‰               |
| groupId      | string   | æ‰€å±ã‚°ãƒ«ãƒ¼ãƒ—ID           |
| count        | number   | ã‚«ã‚¦ãƒ³ãƒˆæ•°               |
| updatedAt    | timestamp| æœ€çµ‚æ›´æ–°æ—¥æ™‚             |

â€» ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDã¯ `${uid}_${day}` å½¢å¼

---

## ğŸ”¹ monthly_counts_usersï¼ˆå€‹äºº æœˆåˆ¥é›†è¨ˆï¼‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | å‹     | èª¬æ˜                     |
|--------------|--------|--------------------------|
| uid          | string | ãƒ¦ãƒ¼ã‚¶ãƒ¼UID              |
| month        | string | æœˆï¼ˆyyyy-MMï¼‰            |
| year         | string | å¹´ï¼ˆyyyyï¼‰               |
| count        | number | æœˆé–“ç´¯è¨ˆã‚«ã‚¦ãƒ³ãƒˆ         |

â€» ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDã¯ `${month}_${uid}` å½¢å¼

---

## ğŸ”¹ yearly_counts_usersï¼ˆå€‹äºº å¹´åˆ¥é›†è¨ˆï¼‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | å‹     | èª¬æ˜                     |
|--------------|--------|--------------------------|
| uid          | string | ãƒ¦ãƒ¼ã‚¶ãƒ¼UID              |
| year         | string | å¹´ï¼ˆyyyyï¼‰               |
| count        | number | å¹´é–“ç´¯è¨ˆã‚«ã‚¦ãƒ³ãƒˆ         |

â€» ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDã¯ `${year}_${uid}` å½¢å¼

---

## ğŸ”¹ total_counts_usersï¼ˆå€‹äºº é€šç®—é›†è¨ˆï¼‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | å‹     | èª¬æ˜                     |
|--------------|--------|--------------------------|
| uid          | string | ãƒ¦ãƒ¼ã‚¶ãƒ¼UID              |
| count        | number | é€šç®—ç´¯è¨ˆã‚«ã‚¦ãƒ³ãƒˆ         |

â€» ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆIDã¯ `uid`

---

## ğŸ”¹ daily_counts_groupsï¼ˆã‚°ãƒ«ãƒ¼ãƒ—é›†è¨ˆãƒ»æ—¥å˜ä½ï¼‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | å‹     | èª¬æ˜                     |
|--------------|--------|--------------------------|
| groupId      | string | ã‚°ãƒ«ãƒ¼ãƒ—ID               |
| day          | string | æ—¥ä»˜ï¼ˆyyyy-MM-ddï¼‰       |
| month        | string | æœˆï¼ˆyyyy-MMï¼‰            |
| year         | string | å¹´ï¼ˆyyyyï¼‰               |
| count        | number | ã‚°ãƒ«ãƒ¼ãƒ—ã®åˆè¨ˆã‚«ã‚¦ãƒ³ãƒˆ   |
| updatedAt    | timestamp | é›†è¨ˆæ—¥æ™‚              |

â€» ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¯ã‚µãƒ–ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¨ã—ã¦è¨­è¨ˆã•ã‚Œã‚‹å ´åˆã‚ã‚Š

---

## ğŸ”¹ notificationsï¼ˆé€šçŸ¥ï¼‰

**ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³åï¼š** `notifications`

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | å‹       | èª¬æ˜                                     |
|--------------|----------|------------------------------------------|
| toUid        | string   | é€šçŸ¥å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼UID                      |
| message      | string   | é€šçŸ¥æœ¬æ–‡                                 |
| timestamp    | timestamp| é€šçŸ¥ä½œæˆæ—¥æ™‚                             |
| isRead       | boolean  | æ—¢èª­ãƒ•ãƒ©ã‚°ï¼ˆfalse = æœªèª­, true = æ—¢èª­ï¼‰   |

---

## ğŸ”¹ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ«ãƒ¼ãƒ«æƒ³å®šï¼ˆæŠœç²‹ï¼‰

- `users/{uid}`ï¼š`request.auth.uid == uid`
- `users/{uid}/group_requests`ï¼š`request.auth.uid == uid`
- `groups`ï¼šèª­ã¿å–ã‚Šã¯å…¨ä½“å…¬é–‹ã€æ›¸ãè¾¼ã¿ã¯ `createdBy == request.auth.uid`
- `notifications`ï¼š`toUid == request.auth.uid`
- `daily_counts` / `*_counts_*`ï¼šèª­ã¿å–ã‚Šåˆ¶é™ï¼ˆå¿…è¦ã«å¿œã˜ã¦ç®¡ç†è€…ã®ã¿ï¼‰

---

## ğŸ”š å‚™è€ƒ

- `counts` ã¯ `daily_counts` ã«ä¸€æœ¬åŒ–ï¼ˆ2025-05æ›´æ–°ï¼‰
- å€‹äººé›†è¨ˆãƒ»ã‚°ãƒ«ãƒ¼ãƒ—é›†è¨ˆã¯ãã‚Œãã‚Œå°‚ç”¨ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«è²¬å‹™åˆ†é›¢
- æ›¸ãè¾¼ã¿é–“éš”ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åˆ¶å¾¡ã«ç§»è¡Œï¼ˆé«˜è² è·æ™‚å¯¾å¿œï¼‰
- ãƒ©ãƒ³ã‚­ãƒ³ã‚°è¡¨ç¤ºã®æœŸé–“åˆ¥é›†è¨ˆã¯ `*_counts_users` ã§å¯¾å¿œæ¸ˆ
