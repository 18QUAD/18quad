
---

## ğŸ“„ users

ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ä¿æŒã™ã‚‹ãƒ«ãƒ¼ãƒˆã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã€‚  
`uid` ã¯ Firebase Authentication ã«é€£å‹•ã€‚

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | å‹ | èª¬æ˜ |
|:---|:---|:---|
| displayName | string | è¡¨ç¤ºå |
| email | string | ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆèªè¨¼ã¨ä¸€è‡´ï¼‰ |
| iconUrl | string | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒURL |
| groupId | string | æ‰€å±ã‚°ãƒ«ãƒ¼ãƒ—IDï¼ˆæœªæ‰€å±æ™‚ã¯ç©ºæ–‡å­—ï¼‰ |
| status | string | none / member / manager |
| createdAt | timestamp | ç™»éŒ²æ™‚åˆ» |

---

## ğŸ“„ countsï¼ˆusers/{uid}/counts ã‚µãƒ–ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ï¼‰

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã®ã€Œé€£æ‰“æ•°ã€è¨˜éŒ²ã€‚  
1ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¤ã1ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆuidä¸€è‡´ï¼‰ã€‚

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | å‹ | èª¬æ˜ |
|:---|:---|:---|
| count | int | é€£æ‰“æ•°ï¼ˆåˆæœŸå€¤0ï¼‰ |
| createdAt | timestamp | ä½œæˆæ—¥æ™‚ |

ğŸ“Œ é›†è¨ˆã«ã¯ `collectionGroup('counts')` ã‚’ä½¿ç”¨ã™ã‚‹ã€‚

---

## ğŸ“„ group_requestsï¼ˆusers/{uid}/group_requests ã‚µãƒ–ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ï¼‰â€»è¨­è¨ˆæ¸ˆ

ã€Œã‚°ãƒ«ãƒ¼ãƒ—å‚åŠ ç”³è«‹ã€ãƒ‡ãƒ¼ã‚¿ã€‚  
ç®¡ç†è€…ã«ã‚ˆã‚‹æ‰¿èªãƒ»æ‹’å¦æ“ä½œã®å¯¾è±¡ã€‚

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | å‹ | èª¬æ˜ |
|:---|:---|:---|
| inviteCode | string | æ‹›å¾…ã‚³ãƒ¼ãƒ‰ or ã‚°ãƒ«ãƒ¼ãƒ—è­˜åˆ¥å­ |
| status | string | pending / approved / rejected |
| createdAt | timestamp | ãƒªã‚¯ã‚¨ã‚¹ãƒˆç”Ÿæˆæ—¥æ™‚ |

---

## ğŸ“„ groups

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä½œæˆã™ã‚‹ã€Œã‚°ãƒ«ãƒ¼ãƒ—ã€ã‚’ç®¡ç†ã™ã‚‹ãƒ«ãƒ¼ãƒˆã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã€‚  
å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® `groupId` ã«ã‚ˆã‚Šæ‰€å±ã‚’ç´ä»˜ã‘ã‚‹ã€‚

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å | å‹ | èª¬æ˜ |
|:---|:---|:---|
| groupName | string | ã‚°ãƒ«ãƒ¼ãƒ—ã®è¡¨ç¤ºå |
| ownerUid | string | ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆè€…ã®UID |
| createdAt | timestamp | ä½œæˆæ—¥æ™‚ |

ğŸ“Œ ã‚°ãƒ«ãƒ¼ãƒ—ã«æ‰€å±ä¸­ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ `users.status = member` ã¾ãŸã¯ `manager` ã¨ã—ã¦åŒºåˆ¥ã•ã‚Œã‚‹ã€‚

---

## ğŸš« éæ¨å¥¨æ§‹æˆï¼ˆæ—§ä»•æ§˜ï¼‰

ã‹ã¤ã¦ä½¿ç”¨ã—ã¦ã„ãŸãŒç¾åœ¨ã¯å»ƒæ­¢æ¸ˆã¿ã®ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«æ§‹æˆï¼š

- `/counts/{uid}` âŒ â†’ `/users/{uid}/counts/{uid}` ã«çµ±åˆ
- `/group_requests/{doc}` âŒ â†’ `/users/{uid}/group_requests/{doc}` ã«çµ±åˆäºˆå®š

---

## âœ… ãƒ¡ãƒ¢

- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆï¼šCloud Functions `createUser`
- ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤ï¼šCloud Functions `deleteUserFully`ï¼ˆAuthenticationå«ã‚å®Œå…¨å‰Šé™¤ï¼‰
- Webå‘ã‘é–¢æ•°ï¼šã™ã¹ã¦ CORS å¯¾å¿œæ¸ˆï¼ˆFlutter Webå¯¾å¿œå®Œäº†ï¼‰

